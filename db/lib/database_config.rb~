require 'yaml'

class DatabaseConfig
  def initialize
    @databases = YAML::load(File.open("config/database.yml"))
    puts @databases.inspect

    unless ENV['DB_ENV']
      ENV['DB_ENV'] = 'development'
    end
  end

  def dev?
    ENV['db_env'] == 'development'
  end

  def test?
    ENV['db_env'] == 'test'
  end

  def prod?
    ENV['db_env'] == 'production'
  end

  def db_str
    if dev?
    elsif test?
      test_db
    elsif prod?
      prod_db
    end
  end

  def connection_string
    db = @databases[ENV['DB_ENV'].to_sym]

    if db[:adapter] == 'sqlite'
      "%s://%s" % [db[:adapter], db[:database]]
    elsif db[:adapter] == 'mysql'
      "%s://%s:%s@%s/%s" % [db[:adapter], db[:username], db[:password], db[:host], db[:database]]
    end
  end
end
